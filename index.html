<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>NAS | Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

<style>
body{font-family:'Cairo',sans-serif}
.card{background:#1f2937;padding:14px;border-radius:14px;margin-bottom:12px}
.input{width:100%;padding:10px;margin-bottom:8px;border-radius:10px;color:black}
.btn{padding:8px;border-radius:10px;background:#374151}
.toast{
 position:fixed;top:20px;left:50%;transform:translateX(-50%);
 background:#111;color:#fff;padding:12px 24px;border-radius:12px;z-index:9999
}
</style>
</head>

<body class="bg-gray-900 text-white p-4 min-h-screen">

<h1 class="text-2xl font-bold text-center mb-4">ğŸ“¦ NAS â€“ Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</h1>

<div id="toast" class="hidden toast"></div>

<!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
<div class="flex justify-center gap-6 mb-4 text-sm">
  <div id="paidCount">Ù…Ø¯ÙÙˆØ¹: 0</div>
  <div id="expiredCount">Ù…Ù†ØªÙ‡ÙŠ: 0</div>
</div>

<!-- Ø§Ù„ÙÙˆØ±Ù… -->
<div class="max-w-md mx-auto card">
  <input id="name" class="input" placeholder="Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†">
  <input id="phone" class="input" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†">
  <input id="service" class="input" placeholder="Ù†ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ">
  <input id="user" class="input" placeholder="ÙŠÙˆØ²Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
  <input id="link" class="input" placeholder="Ø±Ø§Ø¨Ø·">

  <div class="grid grid-cols-3 gap-2 my-3">
    <button class="btn" onclick="setDays(7)">Ø£Ø³Ø¨ÙˆØ¹</button>
    <button class="btn" onclick="setDays(30)">Ø´Ù‡Ø±</button>
    <button class="btn" onclick="setDays(90)">3 Ø£Ø´Ù‡Ø±</button>
    <button class="btn" onclick="setDays(180)">6 Ø£Ø´Ù‡Ø±</button>
    <button class="btn col-span-3" onclick="setDays(365)">Ø³Ù†Ø©</button>
  </div>

  <div class="flex gap-2">
    <button class="bg-green-600 flex-1 btn" onclick="setPaid(true)">Ù…Ø¯ÙÙˆØ¹</button>
    <button class="bg-red-600 flex-1 btn" onclick="setPaid(false)">ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹</button>
  </div>

  <button class="bg-white text-black w-full mt-3 py-2 rounded-xl font-bold" onclick="saveClient()">
    ğŸ’¾ Ø­ÙØ¸
  </button>
</div>

<!-- Ø§Ù„Ø¨Ø­Ø« -->
<div class="max-w-md mx-auto mt-4">
  <input id="search" oninput="render()" class="input" placeholder="ğŸ” Ø¨Ø­Ø«">
</div>

<!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© -->
<div class="max-w-md mx-auto mt-3" id="clients"></div>

<script>
let days = 0;
let paid = null;
let editIndex = null;

const STORAGE_KEY = "NAS_CLIENTS";

let clients = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];

const nameI = name;
const phoneI = phone;
const serviceI = service;
const userI = user;
const linkI = link;
const searchI = search;

function toast(msg){
 const t = document.getElementById("toast");
 t.textContent = msg;
 t.classList.remove("hidden");
 setTimeout(()=>t.classList.add("hidden"),2500);
}

function setDays(d){ days=d; toast("ğŸ“… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¯Ø©"); }
function setPaid(p){ paid=p; toast(p?"âœ… Ù…Ø¯ÙÙˆØ¹":"âŒ ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹"); }

function saveClient(){
 if(!nameI.value || !days || paid===null){
  toast("âš ï¸ Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
  return;
 }

 const start = new Date();
 const end = new Date(start);
 end.setDate(end.getDate()+days);

 const data = {
  name:nameI.value.trim(),
  phone:phoneI.value.trim(),
  service:serviceI.value.trim(),
  user:userI.value.trim(),
  link:linkI.value.trim(),
  paid,
  start:start.toISOString(),
  end:end.toISOString()
 };

 if(editIndex!==null){
  clients[editIndex]=data;
  editIndex=null;
 }else{
  clients.unshift(data);
 }

 localStorage.setItem(STORAGE_KEY, JSON.stringify(clients));
 clearForm();
 render();
 toast("âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­");
}

function clearForm(){
 nameI.value="";
 phoneI.value="";
 serviceI.value="";
 userI.value="";
 linkI.value="";
 days=0;
 paid=null;
}

function render(){
 const q = (searchI.value||"").toLowerCase();
 const list = document.getElementById("clients");
 list.innerHTML="";

 let paidC=0, expC=0;
 const now = new Date();

 clients.forEach((c,i)=>{
  const end = new Date(c.end);
  const diff = (end-now)/(1000*60*60*24);

  if(c.paid) paidC++;
  if(diff<0) expC++;

  if(
   c.name.toLowerCase().includes(q) ||
   c.phone.includes(q) ||
   c.link.toLowerCase().includes(q)
  ){
   list.innerHTML+=`
   <div class="card">
    <div class="flex justify-between">
      <b>${c.name}</b>
      ${diff<0?"â›” Ù…Ù†ØªÙ‡ÙŠ":""}
    </div>
    <div class="text-sm opacity-80">
      ${c.service} | ${c.paid?"Ù…Ø¯ÙÙˆØ¹":"ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹"}<br>
      ğŸ“… ÙŠÙ†ØªÙ‡ÙŠ: ${end.toLocaleDateString("ar")}
    </div>
    <div class="flex gap-2 mt-3">
      <button class="btn" onclick="editClient(${i})">âœï¸</button>
      <button class="btn" onclick="delClient(${i})">ğŸ—‘ï¸</button>
    </div>
   </div>`;
  }
 });

 paidCount.textContent = `Ù…Ø¯ÙÙˆØ¹: ${paidC}`;
 expiredCount.textContent = `Ù…Ù†ØªÙ‡ÙŠ: ${expC}`;
}

function editClient(i){
 const c=clients[i];
 nameI.value=c.name;
 phoneI.value=c.phone;
 serviceI.value=c.service;
 userI.value=c.user;
 linkI.value=c.link;
 paid=c.paid;
 editIndex=i;
 toast("âœï¸ ÙˆØ¶Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„");
}

function delClient(i){
 if(confirm("Ø­Ø°Ù Ø§Ù„Ø²Ø¨ÙˆÙ†ØŸ")){
  clients.splice(i,1);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(clients));
  render();
 }
}

render();
</script>

</body>
</html>
