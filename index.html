<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>NAS | Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

<style>
body{font-family:'Cairo',sans-serif}
.card{background:#1f2937;padding:12px;border-radius:12px;margin-bottom:10px}
.toast{
 position:fixed;top:15px;left:50%;transform:translateX(-50%);
 background:#111;color:#fff;padding:10px 20px;border-radius:10px;z-index:9999
}
</style>
</head>

<body class="bg-gray-900 text-white p-4 min-h-screen">

<h1 class="text-2xl font-bold text-center mb-4">NAS - Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</h1>

<div id="toast" class="hidden toast"></div>

<!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
<div class="flex justify-center gap-6 mb-4">
  <div id="paidCount">Ù…Ø¯ÙÙˆØ¹: 0</div>
  <div id="expiredCount">Ù…Ù†ØªÙ‡ÙŠ: 0</div>
</div>

<!-- Ø§Ù„ÙÙˆØ±Ù… -->
<div class="max-w-md mx-auto card">
  <input id="name" class="input" placeholder="Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†">
  <input id="phone" class="input" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†">
  <input id="service" class="input" placeholder="Ù†ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ (Canva Pro)">
  <input id="user" class="input" placeholder="ÙŠÙˆØ²Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
  <input id="link" class="input" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø²Ø¨ÙˆÙ†">

  <div class="grid grid-cols-3 gap-2 my-3">
    <button onclick="setDays(7)">Ø£Ø³Ø¨ÙˆØ¹ÙŠ</button>
    <button onclick="setDays(30)">Ø´Ù‡Ø±ÙŠ</button>
    <button onclick="setDays(90)">3 Ø£Ø´Ù‡Ø±</button>
    <button onclick="setDays(180)">6 Ø£Ø´Ù‡Ø±</button>
    <button onclick="setDays(365)" class="col-span-3">Ø³Ù†ÙˆÙŠ</button>
  </div>

  <div class="flex gap-2">
    <button class="bg-green-600 flex-1" onclick="setPaid(true)">Ù…Ø¯ÙÙˆØ¹</button>
    <button class="bg-red-600 flex-1" onclick="setPaid(false)">ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹</button>
  </div>

  <button class="bg-white text-black w-full mt-3" onclick="saveClient()">Ø­ÙØ¸ Ø§Ù„Ø²Ø¨ÙˆÙ†</button>
</div>

<!-- Ø§Ù„Ø¨Ø­Ø« -->
<div class="max-w-md mx-auto mt-4">
  <input id="search" oninput="render()" class="input" placeholder="ğŸ” Ø¨Ø­Ø«">
</div>

<!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© -->
<div class="max-w-md mx-auto mt-3" id="clients"></div>

<script>
let days = 0;
let paid = false;
let editIndex = null;

const clients = JSON.parse(localStorage.getItem("clients") || "[]");

const nameI = document.getElementById("name");
const phoneI = document.getElementById("phone");
const serviceI = document.getElementById("service");
const userI = document.getElementById("user");
const linkI = document.getElementById("link");
const searchI = document.getElementById("search");

function toast(msg){
 const t=document.getElementById("toast");
 t.textContent=msg;
 t.classList.remove("hidden");
 setTimeout(()=>t.classList.add("hidden"),3000);
}

function setDays(d){ days=d; toast("ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¯Ø©"); }
function setPaid(p){ paid=p; toast(p?"Ù…Ø¯ÙÙˆØ¹":"ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹"); }

function saveClient(){
 if(!nameI.value || !days){
  alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ø®ØªØ± Ø§Ù„Ù…Ø¯Ø©");
  return;
 }

 const start = new Date();
 const end = new Date(start);
 end.setDate(end.getDate()+days);

 const data = {
  name:nameI.value,
  phone:phoneI.value,
  service:serviceI.value,
  user:userI.value,
  link:linkI.value,
  paid,
  start:start.toISOString(),
  end:end.toISOString()
 };

 if(editIndex!==null){
  clients[editIndex]=data;
  editIndex=null;
 }else{
  clients.push(data);
 }

 localStorage.setItem("clients",JSON.stringify(clients));
 clearForm();
 render();
}

function clearForm(){
 nameI.value=phoneI.value=serviceI.value=userI.value=linkI.value="";
 days=0; paid=false;
}

function render(){
 const q=(searchI.value||"").toLowerCase();
 const list=document.getElementById("clients");
 list.innerHTML="";
 let paidC=0, expC=0;
 const now=new Date();

 clients.forEach((c,i)=>{
  const end=new Date(c.end);
  const diff=(end-now)/(1000*60*60*24);
  if(c.paid) paidC++;
  if(diff<0) expC++;

  if(
   c.name.toLowerCase().includes(q)||
   c.phone.includes(q)||
   c.link.toLowerCase().includes(q)
  ){
   list.innerHTML+=`
   <div class="card">
    ${diff<0?"â­":""} <b>${c.name}</b> - ${c.service}
    <div class="flex gap-2 mt-2">
      <button onclick="editClient(${i})">âœï¸</button>
      <button onclick="delClient(${i})">ğŸ—‘ï¸</button>
    </div>
   </div>`;
  }
 });

 document.getElementById("paidCount").textContent=`Ù…Ø¯ÙÙˆØ¹: ${paidC}`;
 document.getElementById("expiredCount").textContent=`Ù…Ù†ØªÙ‡ÙŠ: ${expC}`;
}

function editClient(i){
 const c=clients[i];
 nameI.value=c.name;
 phoneI.value=c.phone;
 serviceI.value=c.service;
 userI.value=c.user;
 linkI.value=c.link;
 paid=c.paid;
 editIndex=i;
}

function delClient(i){
 if(confirm("Ø­Ø°Ù Ø§Ù„Ø²Ø¨ÙˆÙ†ØŸ")){
  clients.splice(i,1);
  localStorage.setItem("clients",JSON.stringify(clients));
  render();
 }
}

render();
</script>

<style>
.input{
 width:100%;
 padding:8px;
 margin-bottom:8px;
 border-radius:8px;
 color:black
}
button{
 padding:6px;
 border-radius:8px;
 background:#374151
}
</style>

</body>
</html>
