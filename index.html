<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>NAS | Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; background-color: #0f172a; }
        .glass-card { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
        .input-field { background: #1e293b; border: 1px solid #334155; transition: all 0.3s; }
        .input-field:focus { border-color: #3b82f6; outline: none; box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2); }
        .btn-toggle { transition: all 0.2s; border: 1px solid #334155; }
        .btn-active { background-color: #3b82f6 !important; border-color: #60a5fa !important; color: white !important; }
        .toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 100; transition: opacity 0.3s; }
    </style>
</head>
<body class="text-slate-200 p-4 pb-20">

    <div class="max-w-2xl mx-auto mb-6">
        <h1 class="text-3xl font-bold text-center mb-6 text-blue-400">ğŸ“¦ NAS Pro</h1>
        <div class="grid grid-cols-2 gap-4">
            <div class="glass-card p-4 rounded-2xl text-center">
                <p class="text-slate-400 text-sm">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†</p>
                <div id="totalCount" class="text-2xl font-bold">0</div>
            </div>
            <div class="glass-card p-4 rounded-2xl text-center border-b-4 border-red-500">
                <p class="text-slate-400 text-sm">Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ù…Ù†ØªÙ‡ÙŠØ©</p>
                <div id="expiredCount" class="text-2xl font-bold text-red-400">0</div>
            </div>
        </div>
    </div>

    <div class="max-w-2xl mx-auto glass-card p-6 rounded-3xl mb-8">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <input id="name" class="input-field p-3 rounded-xl w-full" placeholder="Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†">
            <input id="phone" class="input-field p-3 rounded-xl w-full" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (Ø¨Ø¯ÙˆÙ† Ù…ÙØªØ§Ø­ Ø§Ù„Ø¯ÙˆÙ„Ø©)">
            <input id="service" class="input-field p-3 rounded-xl w-full" placeholder="Ù†ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ (Ù…Ø«Ù„Ø§Ù‹: ChatGPT)">
            <input id="link" class="input-field p-3 rounded-xl w-full" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø­Ø³Ø§Ø¨/Ø§Ù„Ø®Ø¯Ù…Ø©">
        </div>

        <p class="mt-4 mb-2 text-sm text-slate-400">Ù…Ø¯Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ:</p>
        <div class="grid grid-cols-3 sm:grid-cols-5 gap-2" id="daysContainer">
            <button class="btn-toggle bg-slate-800 p-2 rounded-lg text-xs" onclick="setDays(this, 7)">Ø£Ø³Ø¨ÙˆØ¹</button>
            <button class="btn-toggle bg-slate-800 p-2 rounded-lg text-xs" onclick="setDays(this, 30)">Ø´Ù‡Ø±</button>
            <button class="btn-toggle bg-slate-800 p-2 rounded-lg text-xs" onclick="setDays(this, 90)">3 Ø£Ø´Ù‡Ø±</button>
            <button class="btn-toggle bg-slate-800 p-2 rounded-lg text-xs" onclick="setDays(this, 180)">6 Ø£Ø´Ù‡Ø±</button>
            <button class="btn-toggle bg-slate-800 p-2 rounded-lg text-xs" onclick="setDays(this, 365)">Ø³Ù†Ø©</button>
        </div>

        <div class="flex gap-4 mt-6">
            <button id="btnPaid" class="btn-toggle flex-1 bg-slate-800 p-3 rounded-xl flex items-center justify-center gap-2" onclick="setPaid(true)">
                <span>âœ… Ù…Ø¯ÙÙˆØ¹</span>
            </button>
            <button id="btnUnpaid" class="btn-toggle flex-1 bg-slate-800 p-3 rounded-xl flex items-center justify-center gap-2" onclick="setPaid(false)">
                <span>âŒ ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹</span>
            </button>
        </div>

        <button id="mainBtn" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-4 rounded-2xl mt-6 transition-all shadow-lg shadow-blue-900/20" onclick="saveClient()">
            ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        </button>
        <button id="cancelEdit" class="hidden w-full text-slate-400 mt-2 text-sm underline" onclick="clearForm()">Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„</button>
    </div>

    <div class="max-w-2xl mx-auto mb-6 relative">
        <input id="search" oninput="render()" class="input-field p-4 pr-12 rounded-2xl w-full shadow-inner" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ† Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ...">
        <span class="absolute right-4 top-4 opacity-30">ğŸ”</span>
    </div>

    <div class="max-w-2xl mx-auto space-y-4" id="clientsList"></div>

    <div id="toast" class="hidden toast bg-white text-slate-900 px-6 py-3 rounded-full font-bold shadow-2xl"></div>

    <script>
        const STORAGE_KEY = "NAS_PRO_DATA";
        let clients = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
        let selectedDays = 0;
        let selectedPaid = null;
        let editIndex = null;

        // Elements
        const el = (id) => document.getElementById(id);

        function showToast(msg) {
            const t = el("toast");
            t.textContent = msg;
            t.classList.remove("hidden");
            setTimeout(() => t.classList.add("hidden"), 3000);
        }

        function setDays(btn, val) {
            document.querySelectorAll('#daysContainer button').forEach(b => b.classList.remove('btn-active'));
            btn.classList.add('btn-active');
            selectedDays = val;
        }

        function setPaid(status) {
            el('btnPaid').classList.remove('btn-active');
            el('btnUnpaid').classList.remove('btn-active');
            if(status) el('btnPaid').classList.add('btn-active');
            else el('btnUnpaid').classList.add('btn-active');
            selectedPaid = status;
        }

        function saveClient() {
            const name = el('name').value.trim();
            const phone = el('phone').value.trim();
            const service = el('service').value.trim();
            const link = el('link').value.trim();

            if (!name || selectedDays === 0 || selectedPaid === null) {
                showToast("âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©");
                return;
            }

            const now = new Date();
            const end = new Date();
            end.setDate(now.getDate() + selectedDays);

            const clientData = {
                name, phone, service, link,
                paid: selectedPaid,
                start: editIndex !== null ? clients[editIndex].start : now.toISOString(),
                end: end.toISOString(),
                days: selectedDays
            };

            if (editIndex !== null) {
                clients[editIndex] = clientData;
                editIndex = null;
                el('mainBtn').textContent = "ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª";
                el('cancelEdit').classList.add('hidden');
            } else {
                clients.unshift(clientData);
            }

            localStorage.setItem(STORAGE_KEY, JSON.stringify(clients));
            clearForm();
            render();
            showToast("âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­");
        }

        function clearForm() {
            el('name').value = "";
            el('phone').value = "";
            el('service').value = "";
            el('link').value = "";
            selectedDays = 0;
            selectedPaid = null;
            editIndex = null;
            document.querySelectorAll('.btn-toggle').forEach(b => b.classList.remove('btn-active'));
            el('mainBtn').textContent = "ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª";
            el('cancelEdit').classList.add('hidden');
        }

        function render() {
            const query = el('search').value.toLowerCase();
            const list = el('clientsList');
            list.innerHTML = "";

            let expCount = 0;
            const now = new Date();

            clients.forEach((c, i) => {
                const endDate = new Date(c.end);
                const isExpired = endDate < now;
                if (isExpired) expCount++;

                if (c.name.toLowerCase().includes(query) || c.phone.includes(query)) {
                    const statusColor = c.paid ? 'text-green-400' : 'text-red-400';
                    const timeStatus = isExpired ? 'bg-red-500/20 text-red-400' : 'bg-green-500/20 text-green-400';

                    list.innerHTML += `
                        <div class="glass-card p-5 rounded-2xl border-r-4 ${c.paid ? 'border-green-500' : 'border-red-500'}">
                            <div class="flex justify-between items-start mb-3">
                                <div>
                                    <h3 class="font-bold text-lg">${c.name}</h3>
                                    <p class="text-xs text-slate-400">${c.service || 'Ø¨Ø¯ÙˆÙ† Ù†ÙˆØ¹'}</p>
                                </div>
                                <span class="px-3 py-1 rounded-full text-[10px] font-bold uppercase ${timeStatus}">
                                    ${isExpired ? 'Ù…Ù†ØªÙ‡ÙŠ' : 'Ù†Ø´Ø·'}
                                </span>
                            </div>
                            
                            <div class="text-sm space-y-1 mb-4">
                                <div class="flex justify-between"><span class="opacity-50">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡:</span> <span>${endDate.toLocaleDateString('ar-EG')}</span></div>
                                <div class="flex justify-between"><span class="opacity-50">Ø§Ù„Ø­Ø§Ù„Ø©:</span> <span class="${statusColor}">${c.paid ? 'Ù…Ø¯ÙÙˆØ¹' : 'Ù…Ø·Ù„ÙˆØ¨ Ø¯ÙØ¹'}</span></div>
                            </div>

                            <div class="flex gap-2">
                                <button onclick="editClient(${i})" class="bg-slate-700 hover:bg-slate-600 p-2 px-4 rounded-xl text-sm transition">ØªØ¹Ø¯ÙŠÙ„</button>
                                <button onclick="deleteClient(${i})" class="bg-red-900/30 hover:bg-red-900/50 text-red-400 p-2 px-4 rounded-xl text-sm transition">Ø­Ø°Ù</button>
                                ${c.phone ? `<a href="https://wa.me/${c.phone}" target="_blank" class="mr-auto bg-green-600 hover:bg-green-500 p-2 px-4 rounded-xl text-sm transition flex items-center gap-1">ÙˆØ§ØªØ³Ø§Ø¨</a>` : ''}
                            </div>
                        </div>
                    `;
                }
            });

            el('totalCount').textContent = clients.length;
            el('expiredCount').textContent = expCount;
        }

        function editClient(i) {
            const c = clients[i];
            el('name').value = c.name;
            el('phone').value = c.phone;
            el('service').value = c.service;
            el('link').value = c.link;
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            setPaid(c.paid);
            editIndex = i;
            el('mainBtn').textContent = "ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª";
            el('cancelEdit').classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            showToast("âœï¸ ÙˆØ¶Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù†Ø´Ø·");
        }

        function deleteClient(i) {
            if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø²Ø¨ÙˆÙ†ØŸ")) {
                clients.splice(i, 1);
                localStorage.setItem(STORAGE_KEY, JSON.stringify(clients));
                render();
                showToast("ğŸ—‘ï¸ ØªÙ… Ø§Ù„Ø­Ø°Ù");
            }
        }

        render();
    </script>
</body>
</html>
